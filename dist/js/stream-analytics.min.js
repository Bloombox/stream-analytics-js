!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.StreamAnalytics=e():t.StreamAnalytics=e()}(this,function(){return function(t){function e(n){if(r[n])return r[n].exports;var o=r[n]={exports:{},id:n,loaded:!1};return t[n].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var r={};return e.m=t,e.c=r,e.p="dist/",e(0)}([function(t,e,r){t.exports=r(1)},function(t,e,r){var n=r(2),o=r(5),i=r(6),a=r(7),s=function(t){this.configure(t||{})};s.prototype.configure=function(t){this.client=new a(t),this.userData=null},s.prototype.setUser=function(t){this.userData=t},s.prototype._sendEventFactory=function(t,e){return function(r){var o=n(r,e,{format:"flat"});if("undefined"!=typeof o)throw new i.InvalidInputData("event data is not valid",o);return this._sendEvent(t,r)}},s.prototype._sendEvent=function(t,e){if(null===this.userData)throw new i.MissingUserId("userData was not set");return e.user_data=this.userData,this.client.send(t,e)},s.prototype.trackImpression=s.prototype._sendEventFactory("impression",o.impressionSpec),s.prototype.trackEngagement=s.prototype._sendEventFactory("engagement",o.engagementSpec),s.Client=a,s.errors=i,"undefined"!=typeof window&&r(9)(s),t.exports=s},function(t,e,r){(function(t){(function(t,e,n){"use strict";var o=function(t,e,r){r=i.extend({},i.options,r);var n,a,s=i.runValidations(t,e,r);for(n in s)for(a in s[n])if(i.isPromise(s[n][a]))throw new Error("Use validate.async if you want support for promises");return o.processValidationResults(s,r)},i=o;i.extend=function(t){return[].slice.call(arguments,1).forEach(function(e){for(var r in e)t[r]=e[r]}),t},i.extend(o,{version:{major:0,minor:9,patch:0,metadata:null,toString:function(){var t=i.format("%{major}.%{minor}.%{patch}",i.version);return i.isEmpty(i.version.metadata)||(t+="+"+i.version.metadata),t}},Promise:"undefined"!=typeof Promise?Promise:null,EMPTY_STRING_REGEXP:/^\s*$/,runValidations:function(t,e,r){var n,o,a,s,u,c,f,l=[];(i.isDomElement(t)||i.isJqueryElement(t))&&(t=i.collectFormValues(t));for(n in e){a=i.getDeepObjectValue(t,n),s=i.result(e[n],a,t,n,r,e);for(o in s){if(u=i.validators[o],!u)throw f=i.format("Unknown validator %{name}",{name:o}),new Error(f);c=s[o],c=i.result(c,a,t,n,r,e),c&&l.push({attribute:n,value:a,validator:o,globalOptions:r,attributes:t,options:c,error:u.call(u,a,c,n,t,r)})}}return l},processValidationResults:function(t,e){var r;switch(t=i.pruneEmptyErrors(t,e),t=i.expandMultipleErrors(t,e),t=i.convertErrorMessages(t,e),e.format||"grouped"){case"detailed":break;case"flat":t=i.flattenErrorsToArray(t);break;case"grouped":t=i.groupErrorsByAttribute(t);for(r in t)t[r]=i.flattenErrorsToArray(t[r]);break;default:throw new Error(i.format("Unknown format %{format}",e))}return i.isEmpty(t)?void 0:t},async:function(t,e,r){r=i.extend({},i.async.options,r);var n=r.wrapErrors||function(t){return t};r.cleanAttributes!==!1&&(t=i.cleanAttributes(t,e));var o=i.runValidations(t,e,r);return new i.Promise(function(a,s){i.waitForResults(o).then(function(){var u=i.processValidationResults(o,r);u?s(new n(u,r,t,e)):a(t)},function(t){s(t)})})},single:function(t,e,r){return r=i.extend({},i.single.options,r,{format:"flat",fullMessages:!1}),i({single:t},{single:e},r)},waitForResults:function(t){return t.reduce(function(t,e){return i.isPromise(e.error)?t.then(function(){return e.error.then(function(t){e.error=t||null},function(t){if(t instanceof Error)throw t;i.error("Rejecting promises with the result is deprecated. Please use the resolve callback instead."),e.error=t})}):t},new i.Promise(function(t){t()}))},result:function(t){var e=[].slice.call(arguments,1);return"function"==typeof t&&(t=t.apply(null,e)),t},isNumber:function(t){return"number"==typeof t&&!isNaN(t)},isFunction:function(t){return"function"==typeof t},isInteger:function(t){return i.isNumber(t)&&t%1===0},isObject:function(t){return t===Object(t)},isDate:function(t){return t instanceof Date},isDefined:function(t){return null!==t&&void 0!==t},isPromise:function(t){return!!t&&i.isFunction(t.then)},isJqueryElement:function(t){return t&&i.isString(t.jquery)},isDomElement:function(t){return!!t&&(!(!i.isFunction(t.querySelectorAll)||!i.isFunction(t.querySelector))&&(!(!i.isObject(document)||t!==document)||("object"==typeof HTMLElement?t instanceof HTMLElement:t&&"object"==typeof t&&null!==t&&1===t.nodeType&&"string"==typeof t.nodeName)))},isEmpty:function(t){var e;if(!i.isDefined(t))return!0;if(i.isFunction(t))return!1;if(i.isString(t))return i.EMPTY_STRING_REGEXP.test(t);if(i.isArray(t))return 0===t.length;if(i.isDate(t))return!1;if(i.isObject(t)){for(e in t)return!1;return!0}return!1},format:i.extend(function(t,e){return i.isString(t)?t.replace(i.format.FORMAT_REGEXP,function(t,r,n){return"%"===r?"%{"+n+"}":String(e[n])}):t},{FORMAT_REGEXP:/(%?)%\{([^\}]+)\}/g}),prettify:function(t){return i.isNumber(t)?100*t%1===0?""+t:parseFloat(Math.round(100*t)/100).toFixed(2):i.isArray(t)?t.map(function(t){return i.prettify(t)}).join(", "):i.isObject(t)?t.toString():(t=""+t,t.replace(/([^\s])\.([^\s])/g,"$1 $2").replace(/\\+/g,"").replace(/[_-]/g," ").replace(/([a-z])([A-Z])/g,function(t,e,r){return""+e+" "+r.toLowerCase()}).toLowerCase())},stringifyValue:function(t){return i.prettify(t)},isString:function(t){return"string"==typeof t},isArray:function(t){return"[object Array]"==={}.toString.call(t)},contains:function(t,e){return!!i.isDefined(t)&&(i.isArray(t)?t.indexOf(e)!==-1:e in t)},forEachKeyInKeypath:function(t,e,r){if(i.isString(e)){var n,o="",a=!1;for(n=0;n<e.length;++n)switch(e[n]){case".":a?(a=!1,o+="."):(t=r(t,o,!1),o="");break;case"\\":a?(a=!1,o+="\\"):a=!0;break;default:a=!1,o+=e[n]}return r(t,o,!0)}},getDeepObjectValue:function(t,e){if(i.isObject(t))return i.forEachKeyInKeypath(t,e,function(t,e){if(i.isObject(t))return t[e]})},collectFormValues:function(t,e){var r,n,o,a,s={};if(i.isJqueryElement(t)&&(t=t[0]),!t)return s;for(e=e||{},o=t.querySelectorAll("input[name], textarea[name]"),r=0;r<o.length;++r)n=o.item(r),i.isDefined(n.getAttribute("data-ignored"))||(a=i.sanitizeFormValue(n.value,e),"number"===n.type?a=a?+a:null:"checkbox"===n.type?n.attributes.value?n.checked||(a=s[n.name]||null):a=n.checked:"radio"===n.type&&(n.checked||(a=s[n.name]||null)),s[n.name]=a);for(o=t.querySelectorAll("select[name]"),r=0;r<o.length;++r)n=o.item(r),a=i.sanitizeFormValue(n.options[n.selectedIndex].value,e),s[n.name]=a;return s},sanitizeFormValue:function(t,e){return e.trim&&i.isString(t)&&(t=t.trim()),e.nullify!==!1&&""===t?null:t},capitalize:function(t){return i.isString(t)?t[0].toUpperCase()+t.slice(1):t},pruneEmptyErrors:function(t){return t.filter(function(t){return!i.isEmpty(t.error)})},expandMultipleErrors:function(t){var e=[];return t.forEach(function(t){i.isArray(t.error)?t.error.forEach(function(r){e.push(i.extend({},t,{error:r}))}):e.push(t)}),e},convertErrorMessages:function(t,e){e=e||{};var r=[];return t.forEach(function(t){var n=i.result(t.error,t.value,t.attribute,t.options,t.attributes,t.globalOptions);return i.isString(n)?("^"===n[0]?n=n.slice(1):e.fullMessages!==!1&&(n=i.capitalize(i.prettify(t.attribute))+" "+n),n=n.replace(/\\\^/g,"^"),n=i.format(n,{value:i.stringifyValue(t.value)}),void r.push(i.extend({},t,{error:n}))):void r.push(t)}),r},groupErrorsByAttribute:function(t){var e={};return t.forEach(function(t){var r=e[t.attribute];r?r.push(t):e[t.attribute]=[t]}),e},flattenErrorsToArray:function(t){return t.map(function(t){return t.error})},cleanAttributes:function(t,e){function r(t,e,r){return i.isObject(t[e])?t[e]:t[e]=!!r||{}}function n(t){var e,n={};for(e in t)t[e]&&i.forEachKeyInKeypath(n,e,r);return n}function o(t,e){if(!i.isObject(t))return t;var r,n,a=i.extend({},t);for(n in t)r=e[n],i.isObject(r)?a[n]=o(a[n],r):r||delete a[n];return a}return i.isObject(e)&&i.isObject(t)?(e=n(e),o(t,e)):{}},exposeModule:function(t,e,r,n,o){r?(n&&n.exports&&(r=n.exports=t),r.validate=t):(e.validate=t,t.isFunction(o)&&o.amd&&o([],function(){return t}))},warn:function(t){"undefined"!=typeof console&&console.warn&&console.warn("[validate.js] "+t)},error:function(t){"undefined"!=typeof console&&console.error&&console.error("[validate.js] "+t)}}),o.validators={presence:function(t,e){if(e=i.extend({},this.options,e),i.isEmpty(t))return e.message||this.message||"can't be blank"},length:function(t,e,r){if(!i.isEmpty(t)){e=i.extend({},this.options,e);var n,o=e.is,a=e.maximum,s=e.minimum,u=e.tokenizer||function(t){return t},c=[];t=u(t);var f=t.length;return i.isNumber(f)?(i.isNumber(o)&&f!==o&&(n=e.wrongLength||this.wrongLength||"is the wrong length (should be %{count} characters)",c.push(i.format(n,{count:o}))),i.isNumber(s)&&f<s&&(n=e.tooShort||this.tooShort||"is too short (minimum is %{count} characters)",c.push(i.format(n,{count:s}))),i.isNumber(a)&&f>a&&(n=e.tooLong||this.tooLong||"is too long (maximum is %{count} characters)",c.push(i.format(n,{count:a}))),c.length>0?e.message||c:void 0):(i.error(i.format("Attribute %{attr} has a non numeric value for `length`",{attr:r})),e.message||this.notValid||"has an incorrect length")}},numericality:function(t,e){if(!i.isEmpty(t)){e=i.extend({},this.options,e);var r,n,o=[],a={greaterThan:function(t,e){return t>e},greaterThanOrEqualTo:function(t,e){return t>=e},equalTo:function(t,e){return t===e},lessThan:function(t,e){return t<e},lessThanOrEqualTo:function(t,e){return t<=e}};if(e.noStrings!==!0&&i.isString(t)&&(t=+t),!i.isNumber(t))return e.message||e.notValid||this.notValid||"is not a number";if(e.onlyInteger&&!i.isInteger(t))return e.message||e.notInteger||this.notInteger||"must be an integer";for(r in a)if(n=e[r],i.isNumber(n)&&!a[r](t,n)){var s="not"+i.capitalize(r),u=e[s]||this[s]||"must be %{type} %{count}";o.push(i.format(u,{count:n,type:i.prettify(r)}))}return e.odd&&t%2!==1&&o.push(e.notOdd||this.notOdd||"must be odd"),e.even&&t%2!==0&&o.push(e.notEven||this.notEven||"must be even"),o.length?e.message||o:void 0}},datetime:i.extend(function(t,e){if(!i.isFunction(this.parse)||!i.isFunction(this.format))throw new Error("Both the parse and format functions needs to be set to use the datetime/date validator");if(!i.isEmpty(t)){e=i.extend({},this.options,e);var r,n=[],o=e.earliest?this.parse(e.earliest,e):NaN,a=e.latest?this.parse(e.latest,e):NaN;return t=this.parse(t,e),isNaN(t)||e.dateOnly&&t%864e5!==0?e.message||this.notValid||"must be a valid date":(!isNaN(o)&&t<o&&(r=this.tooEarly||"must be no earlier than %{date}",r=i.format(r,{date:this.format(o,e)}),n.push(r)),!isNaN(a)&&t>a&&(r=this.tooLate||"must be no later than %{date}",r=i.format(r,{date:this.format(a,e)}),n.push(r)),n.length?e.message||n:void 0)}},{parse:null,format:null}),date:function(t,e){return e=i.extend({},e,{dateOnly:!0}),i.validators.datetime.call(i.validators.datetime,t,e)},format:function(t,e){(i.isString(e)||e instanceof RegExp)&&(e={pattern:e}),e=i.extend({},this.options,e);var r,n=e.message||this.message||"is invalid",o=e.pattern;if(!i.isEmpty(t))return i.isString(t)?(i.isString(o)&&(o=new RegExp(e.pattern,e.flags)),r=o.exec(t),r&&r[0].length==t.length?void 0:n):n},inclusion:function(t,e){if(!i.isEmpty(t)&&(i.isArray(e)&&(e={within:e}),e=i.extend({},this.options,e),!i.contains(e.within,t))){var r=e.message||this.message||"^%{value} is not included in the list";return i.format(r,{value:t})}},exclusion:function(t,e){if(!i.isEmpty(t)&&(i.isArray(e)&&(e={within:e}),e=i.extend({},this.options,e),i.contains(e.within,t))){var r=e.message||this.message||"^%{value} is restricted";return i.format(r,{value:t})}},email:i.extend(function(t,e){e=i.extend({},this.options,e);var r=e.message||this.message||"is not a valid email";if(!i.isEmpty(t))return i.isString(t)&&this.PATTERN.exec(t)?void 0:r},{PATTERN:/^[a-z0-9\u007F-\uffff!#$%&'*+\/=?^_`{|}~-]+(?:\.[a-z0-9\u007F-\uffff!#$%&'*+\/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z]{2,}$/i}),equality:function(t,e,r,n){if(!i.isEmpty(t)){i.isString(e)&&(e={attribute:e}),e=i.extend({},this.options,e);var o=e.message||this.message||"is not equal to %{attribute}";if(i.isEmpty(e.attribute)||!i.isString(e.attribute))throw new Error("The attribute must be a non empty string");var a=i.getDeepObjectValue(n,e.attribute),s=e.comparator||function(t,e){return t===e};return s(t,a,e,r,n)?void 0:i.format(o,{attribute:i.prettify(e.attribute)})}},url:function(t,e){if(!i.isEmpty(t)){e=i.extend({},this.options,e);var r=e.message||this.message||"is not a valid url",n=e.schemes||this.schemes||["http","https"],o=e.allowLocal||this.allowLocal||!1;if(!i.isString(t))return r;var a="^(?:(?:"+n.join("|")+"):\\/\\/)(?:\\S+(?::\\S*)?@)?";a+="(?:";var s="(?:(?:[a-z\\u00a1-\\uffff0-9]+-?)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]+-?)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,})))";o?s="(?:localhost|"+s+")":a+="(?!10(?:\\.\\d{1,3}){3})(?!127(?:\\.\\d{1,3}){3})(?!169\\.254(?:\\.\\d{1,3}){2})(?!192\\.168(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})",a+="(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|"+s+"(?::\\d{2,5})?(?:\\/[^\\s]*)?$";var u=new RegExp(a,"i");return u.exec(t)?void 0:r}}},o.exposeModule(o,this,t,e,r(4))}).call(this,e,t,r(4))}).call(e,r(3)(t))},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children=[],t.webpackPolyfill=1),t}},function(t,e){t.exports=function(){throw new Error("define cannot be used indirect")}},function(t,e,r){var n=r(2);n.validators.features=function(t){if("undefined"==typeof t||null===t)return t;if(!n.isArray(t))return"needs to be a list of features";for(var e=t.length-1;e>=0;e--)if(n(t[e],o))return"should have group and value keys"},n.validators.isArray=function(t){if(!n.isArray(t))return"needs to be an array"},n.validators.isObject=function(t){if(!n.isArray(t))return"needs to be an array"};var o={group:{presence:!0},value:{presence:!0}},i={label:{presence:!0},content:{presence:!0},boost:{presence:!1,numericality:!0},features:{features:!0}},a={content_list:{presence:!0,isArray:!0},boost:{presence:!1,numericality:!0},features:{features:!0}};t.exports={engagementSpec:i,impressionSpec:a}},function(t,e){function r(t,e){this.message=t,Error.call(this,this.message),o?Error.captureStackTrace(this,e):i?this.stack=(new Error).stack:this.stack=""}var n=t.exports,o="function"==typeof Error.captureStackTrace,i=!!(new Error).stack;n._Abstract=r,r.prototype=new Error,n.MissingUserId=function(t){r.call(this,t)},n.MissingUserId.prototype=new r,n.MisconfiguredClient=function(t){r.call(this,t)},n.MisconfiguredClient.prototype=new r,n.InvalidInputData=function(t,e){r.call(this,t+": \n\t"+e.join("\n\t"))},n.InvalidInputData.prototype=new r,n.APIError=function(t){r.call(this,t)},n.APIError.prototype=new r},function(t,e,r){var n=r(8),o=r(6),i=function(){this.initialize.apply(this,arguments)};i.prototype={baseUrl:"https://analytics.stream-io-api.com/analytics/v1.0/",initialize:function(t){var e=t||{};if(!e.apiKey||!e.token)throw new o.MisconfiguredClient("the client must be initialized with apiKey and token");this.apiKey=e.apiKey,this.token=e.token},send:function(t,e){var r=function(t,e){if(t)throw t;if(!/^2\d\d$/.test(e.statusCode))throw new o.APIError(e.responseText)};return this.post({url:this.baseUrl+t+"/",body:e},r)},userAgent:function(){var t=this.node?"node":"browser",e="unknown";return"stream-javascript-client-"+t+"-"+e},enrichKwargs:function(t){return void 0===t.qs&&(t.qs={}),t.qs.api_key=this.apiKey,t.json=!0,t.headers={},t.headers["stream-auth-type"]="jwt",t.headers.Authorization=this.token,t.headers["X-Stream-Client"]=this.userAgent(),t.timeout=1e4,t},post:function(t,e){return t=this.enrichKwargs(t),t.method="POST",n(t,e)}},t.exports=i},function(t,e){function r(t,e){if("function"!=typeof e)throw new Error("Bad callback given: "+e);if(!t)throw new Error("No options given");var a=t.onResponse;if(t="string"==typeof t?{uri:t}:JSON.parse(JSON.stringify(t)),t.onResponse=a,t.verbose&&(r.log=i()),t.url&&(t.uri=t.url,delete t.url),!t.uri&&""!==t.uri)throw new Error("options.uri is a required argument");if("string"!=typeof t.uri)throw new Error("options.uri must be a string");for(var s=["proxy","_redirectsFollowed","maxRedirects","followRedirect"],c=0;c<s.length;c++)if(t[s[c]])throw new Error("options."+s[c]+" is not supported");if(t.callback=e,t.method=t.method||"GET",t.headers=t.headers||{},t.body=t.body||null,t.timeout=t.timeout||r.DEFAULT_TIMEOUT,t.headers.host)throw new Error("Options.headers.host is not supported");t.json&&(t.headers.accept=t.headers.accept||"application/json","GET"!==t.method&&(t.headers["content-type"]="application/json"),"boolean"!=typeof t.json?t.body=JSON.stringify(t.json):"string"!=typeof t.body&&null!==t.body&&(t.body=JSON.stringify(t.body)));var f=function(t){var e=[];for(var r in t)t.hasOwnProperty(r)&&e.push(encodeURIComponent(r)+"="+encodeURIComponent(t[r]));return e.join("&")};if(t.qs){var l="string"==typeof t.qs?t.qs:f(t.qs);t.uri.indexOf("?")!==-1?t.uri=t.uri+"&"+l:t.uri=t.uri+"?"+l}var d=function(t){var e={};e.boundry="-------------------------------"+Math.floor(1e9*Math.random());var r=[];for(var n in t)t.hasOwnProperty(n)&&r.push("--"+e.boundry+'\nContent-Disposition: form-data; name="'+n+'"\n\n'+t[n]+"\n");return r.push("--"+e.boundry+"--"),e.body=r.join(""),e.length=e.body.length,e.type="multipart/form-data; boundary="+e.boundry,e};if(t.form){if("string"==typeof t.form)throw"form name unsupported";if("POST"===t.method){var p=(t.encoding||"application/x-www-form-urlencoded").toLowerCase();switch(t.headers["content-type"]=p,p){case"application/x-www-form-urlencoded":t.body=f(t.form).replace(/%20/g,"+");break;case"multipart/form-data":var h=d(t.form);t.body=h.body,t.headers["content-type"]=h.type;break;default:throw new Error("unsupported encoding:"+p)}}}return t.onResponse=t.onResponse||o,t.onResponse===!0&&(t.onResponse=e,t.callback=o),!t.headers.authorization&&t.auth&&(t.headers.authorization="Basic "+u(t.auth.username+":"+t.auth.password)),n(t)}function n(t){function e(){f=!0;var e=new Error("ETIMEDOUT");return e.code="ETIMEDOUT",e.duration=t.timeout,r.log.error("Timeout",{id:u._id,milliseconds:t.timeout}),t.callback(e,u)}function n(t){return f?r.log.debug("Ignoring timed out state change",{state:u.readyState,id:u.id}):(r.log.debug("State change",{state:u.readyState,id:u.id,timed_out:f}),void(1===u.readyState?r.log.debug("Request started",{id:u.id}):2===u.readyState?o():3===u.readyState?(o(),i()):4===u.readyState&&(o(),i(),a())))}function o(){if(!m.response){if(m.response=!0,r.log.debug("Got response",{id:u.id,status:u.status}),clearTimeout(u.timeoutTimer),u.statusCode=u.status,d&&0==u.statusCode){var e=new Error("CORS request rejected: "+t.uri);return e.cors="rejected",m.loading=!0,m.end=!0,t.callback(e,u)}t.onResponse(null,u)}}function i(){m.loading||(m.loading=!0,r.log.debug("Response body loading",{id:u.id}))}function a(){if(!m.end){if(m.end=!0,r.log.debug("Request done",{id:u.id}),u.body=u.responseText,t.json)try{u.body=JSON.parse(u.responseText)}catch(e){return t.callback(e,u)}t.callback(null,u,u.body)}}var u=new c,f=!1,d=s(t.uri),p="withCredentials"in u;if(l+=1,u.seq_id=l,u.id=l+": "+t.method+" "+t.uri,u._id=u.id,d&&!p){var h=new Error("Browser does not support cross-origin request: "+t.uri);return h.cors="unsupported",t.callback(h,u)}u.timeoutTimer=setTimeout(e,t.timeout);var m={response:!1,loading:!1,end:!1};u.onreadystatechange=n,u.open(t.method,t.uri,!0),d&&(u.withCredentials=!!t.withCredentials);for(var y in t.headers)u.setRequestHeader(y,t.headers[y]);return u.send(t.body),u}function o(){}function i(){var t,e,r={},n=["trace","debug","info","warn","error"];for(e=0;e<n.length;e++)t=n[e],r[t]=o,"undefined"!=typeof console&&console&&console[t]&&(r[t]=a(console,t));return r}function a(t,e){function r(r,n){return"object"==typeof n&&(r+=" "+JSON.stringify(n)),t[e].call(t,r)}return r}function s(t){if(!window.location)return!1;var e,r=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/;try{e=location.href}catch(n){e=document.createElement("a"),e.href="",e=e.href}var o=r.exec(e.toLowerCase())||[],i=r.exec(t.toLowerCase()),a=!(!i||i[1]==o[1]&&i[2]==o[2]&&(i[3]||("http:"===i[1]?80:443))==(o[3]||("http:"===o[1]?80:443)));return a}function u(t){var e,r,n,o,i,a,s,u,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",f=0,l=0,d="",p=[];if(!t)return t;do e=t.charCodeAt(f++),r=t.charCodeAt(f++),n=t.charCodeAt(f++),u=e<<16|r<<8|n,o=u>>18&63,i=u>>12&63,a=u>>6&63,s=63&u,p[l++]=c.charAt(o)+c.charAt(i)+c.charAt(a)+c.charAt(s);while(f<t.length);switch(d=p.join(""),t.length%3){case 1:d=d.slice(0,-2)+"==";break;case 2:d=d.slice(0,-1)+"="}return d}var c=XMLHttpRequest;if(!c)throw new Error("missing XMLHttpRequest");r.log={trace:o,debug:o,info:o,warn:o,error:o};var f=18e4,l=0;r.withCredentials=!1,r.DEFAULT_TIMEOUT=f,r.defaults=function(t,e){var n=function(e){var r=function(r,n){r="string"==typeof r?{uri:r}:JSON.parse(JSON.stringify(r));for(var o in t)void 0===r[o]&&(r[o]=t[o]);return e(r,n)};return r},o=n(r);return o.get=n(r.get),o.post=n(r.post),o.put=n(r.put),o.head=n(r.head),o};var d=["get","put","post","head"];d.forEach(function(t){var e=t.toUpperCase(),n=t.toLowerCase();r[n]=function(t){"string"==typeof t?t={method:e,uri:t}:(t=JSON.parse(JSON.stringify(t)),t.method=e);var n=[t].concat(Array.prototype.slice.apply(arguments,[1]));return r.apply(this,n)}}),r.couch=function(t,e){function n(t,r,n){if(t)return e(t,r,n);if((r.statusCode<200||r.statusCode>299)&&n.error){t=new Error("CouchDB error: "+(n.error.reason||n.error.error));for(var o in n)t[o]=n[o];return e(t,r,n)}return e(t,r,n)}"string"==typeof t&&(t={uri:t}),t.json=!0,t.body&&(t.json=t.body),delete t.body,e=e||o;var i=r(t,n);return i},t.exports=r},function(t,e,r){var n=r(10);t.exports=function(t){var e,r=window.StreamAnalytics||null,o=window._StreamAnalytics||null;r&&o&&(e=o.clients||{},n(e,function(e){n(t.prototype,function(t,e){r.prototype[e]=t}),e._config&&e.configure.call(e,e._config),e._setUser&&n(e._setUser,function(t){e.setUser.apply(e,t)}),e._trackImpression&&n(e._trackImpression,function(t){e.trackImpression.apply(e,t)}),e._trackEngagement&&n(e._trackEngagement,function(t){e.trackEngagement.apply(e,t)}),n(["_config","_setUser","_trackEngagement","_trackImpression"],function(t){if(e[t]){e[t]=void 0;try{delete e[t]}catch(r){}}})})),window._StreamAnalytics=void 0;try{delete window._StreamAnalytics}catch(i){}}},function(t,e){t.exports=function(t,e,r){var n;if(!t)return 0;if(r=r?r:t,t instanceof Array){for(n=0;n<t.length;n++)if(e.call(r,t[n],n,t)===!1)return 0}else for(n in t)if(t.hasOwnProperty(n)&&e.call(r,t[n],n,t)===!1)return 0;return 1}}])});